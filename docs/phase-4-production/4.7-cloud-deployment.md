# Cloud Deployment

Your application works locally. Now it needs to work on the internet. Cloud deployment takes your containers and runs them on servers that anyone can reach.

## Why This Matters

Localhost isn't accessible to users. Cloud deployment means your job market analyzer is available 24/7, scales with traffic, and has proper HTTPS.

## The Key Ideas

### VM Setup

The simplest deployment: a virtual machine running your containers.

```bash
# On a fresh Ubuntu VM:

# Install Docker
curl -fsSL https://get.docker.com | sh

# Clone your code
git clone your-repo

# Start services
cd your-repo
docker-compose up -d
```

Works for modest scale. Easy to understand.

### HTTPS with Caddy

Caddy handles HTTPS automatically:

```
# Caddyfile
yourdomain.com {
    reverse_proxy localhost:8000
}
```

```bash
caddy run
```

Automatic Let's Encrypt certificates. Zero configuration.

### Health Checks

Let infrastructure know your app is healthy:

```python
@app.get("/health")
def health():
    return {"status": "healthy", "timestamp": datetime.utcnow()}

@app.get("/ready")
def ready():
    # Check dependencies
    db_ok = check_database()
    cache_ok = check_cache()
    return {"ready": db_ok and cache_ok}
```

Load balancers use these to route traffic.

### Logging

Structured logs for production:

```python
import logging
import json

class JSONFormatter(logging.Formatter):
    def format(self, record):
        return json.dumps({
            "timestamp": self.formatTime(record),
            "level": record.levelname,
            "message": record.getMessage(),
            "module": record.module
        })

logging.basicConfig(level="INFO", handlers=[...])
```

Structured logs are searchable and parseable.

### Environment Configuration

Never hardcode production values:

```python
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    openai_api_key: str
    database_url: str
    environment: str = "production"

    class Config:
        env_file = ".env"
```

Different `.env` for different environments.

## What's in This Module

| File | What it shows |
|------|---------------|
| <a href="../../modules/Phase%204%20-%20Production%20Systems/4.7-cloud-deployment/01_vm_setup.md">01_vm_setup.md</a> | Setting up a cloud VM |
| <a href="../../modules/Phase%204%20-%20Production%20Systems/4.7-cloud-deployment/02_https_caddy.md">02_https_caddy.md</a> | HTTPS with Caddy |
| <a href="../../modules/Phase%204%20-%20Production%20Systems/4.7-cloud-deployment/03_health_checks.py">03_health_checks.py</a> | Health and readiness endpoints |
| <a href="../../modules/Phase%204%20-%20Production%20Systems/4.7-cloud-deployment/04_logging_config.py">04_logging_config.py</a> | Production logging |

## Deployment Options

| Option | Complexity | Scale | Cost |
|--------|------------|-------|------|
| Single VM | Low | Small | $ |
| Docker Swarm | Medium | Medium | $$ |
| Kubernetes | High | Large | $$$ |
| Managed (Railway, Render) | Low | Medium | $$ |
| Serverless | Medium | Variable | $ (per use) |

Start simple. Add complexity when needed.

## Production Checklist

- [ ] HTTPS enabled
- [ ] Health checks implemented
- [ ] Structured logging
- [ ] Environment variables (not hardcoded)
- [ ] Database backups configured
- [ ] Monitoring/alerting set up
- [ ] Rate limiting enabled
- [ ] Error handling and fallbacks

## Cloud Providers

### AWS
- EC2 for VMs
- ECS for containers
- RDS for PostgreSQL

### Google Cloud
- Compute Engine for VMs
- Cloud Run for containers
- Cloud SQL for PostgreSQL

### DigitalOcean/Linode
- Simple VMs
- Managed databases
- Lower complexity

## Things to Think About

- **What about scaling?** Start with vertical (bigger VM). Add horizontal (more instances) when needed.
- **How do you handle downtime during deploys?** Blue-green deployment, rolling updates, or just accept brief downtime for simple apps.
- **What about costs?** Start small. Monitor usage. Scale up when traffic justifies it.

## Related

- [Docker](./4.1-docker.md) - Containerizing for deployment
- [CI/CD](./4.8-cicd.md) - Automating deployments
- [Observability](./4.3-observability.md) - Monitoring in production

## Book References

- AI_eng.10 - Deployment considerations
